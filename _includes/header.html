<header class="border-b border-gray-300 dark:border-gray-700 dark:text-gray-50">
    <div class="container mx-auto px-4 sm:px-6 flex items-center justify-between py-4 sm:py-6 border-x border-gray-300 dark:border-gray-700 bg-white dark:bg-black">
        <a href="/" class="p-2">
            <img src="/logo.svg" alt="Pixelarticons" class="h-5 sm:h-6 hover:scale-110 hover:-rotate-6 transition-all duration-100">
        </a>
        <nav class="hidden sm:flex items-center gap-2" x-data="{ 
            currentPath: '',
            init() {
                this.currentPath = window.location.pathname;
            },
            isActive(path) {
                const normalizedPath = this.currentPath.replace(/\/$/, '').replace(/\.html$/, '');
                const normalizedTarget = path.replace(/\/$/, '').replace(/\.html$/, '');
                if (normalizedTarget === '') {
                    return normalizedPath === '' || normalizedPath === '/';
                }
                return normalizedPath === normalizedTarget || normalizedPath.startsWith(normalizedTarget + '/');
            }
        }">
            <a 
                class="flex items-center gap-2 rounded hover:underline group px-4 py-2"
                :class="isActive('/') ? 'underline' : ''"
                href="/"
            >
                Icons<span 
                    class="size-1 bg-black outline outline-2 outline-black dark:outline-white group-hover:animate-spin group-hover:bg-primary"
                    :class="isActive('/') ? 'animate-spin bg-primary' : ''"
                ></span>
            </a>
            <a 
                class="flex items-center gap-2 rounded hover:underline group px-4 py-2"
                :class="isActive('/about') ? 'underline' : ''"
                href="/about"
            >
                About <span 
                    class="size-1 bg-black outline outline-2 outline-black dark:outline-white group-hover:animate-spin group-hover:bg-primary"
                    :class="isActive('/about') ? 'animate-spin bg-primary' : ''"
                ></span>
            </a>
            <a 
                class="flex items-center gap-2 rounded hover:underline group px-4 py-2"
                :class="isActive('/legacy') ? 'underline' : ''"
                href="/legacy"
            >
                Legacy <span 
                    class="size-1 bg-black outline outline-2 outline-black dark:outline-white group-hover:animate-spin group-hover:bg-primary"
                    :class="isActive('/legacy') ? 'animate-spin bg-primary' : ''"
                ></span>
            </a>
        </nav>
        <!-- <nav class="flex items-center gap-0 md:gap-2">
            <a class="hover:opacity-50" href="https://github.com/halfmage/pixelarticons" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="size-6">
                    <path fill="currentColor" d="M5 2h4v2H7v2H5V2Zm0 10H3V6h2v6Zm2 2H5v-2h2v2Zm2 2v-2H7v2H3v-2H1v2h2v2h4v4h2v-4h2v-2H9Zm0 0v2H7v-2h2Zm6-12v2H9V4h6Zm4 2h-2V4h-2V2h4v4Zm0 6V6h2v6h-2Zm-2 2v-2h2v2h-2Zm-2 2v-2h2v2h-2Zm0 2h-2v-2h2v2Zm0 0h2v4h-2v-4Z"/>
                </svg>              
            </a>
            <a class="ml-2 hover:opacity-50" href="https://www.npmjs.com/package/pixelarticons" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="size-6">
                    <path fill="currentColor" d="M3 3h18v18h-6V10h-3v11H3V3Zm14 16h2V5H5v14h5V8h7v11Z"/>
                </svg>                                        
            </a>
            <a class="ml-2 hover:opacity-50" href="https://www.figma.com/community/file/952542622393317653" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="size-6">
                    <path fill="currentColor" d="M11 2H7v2H5v4h2v2H5v4h2v2H5v4h2v2h4v-2h2v-4h4v-2h2v-4h-2V8h2V4h-2V2h-6Zm6 2v4h-4V4h4Zm-4 10v-4h4v4h-4Zm-2 6H7v-4h4v4Zm-4-6v-4h4v4H7Zm0-6V4h4v4H7Z"/>
                </svg>              
            </a>
            <a class="ml-2 hover:opacity-50" href="https://halfmage.gumroad.com/l/pixelarticons">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="size-6">
                    <path fill="currentColor" d="M9 2h6v2H9V2Zm6 4V4h2v2h4v16H3V6h4V4h2v2h6Zm0 2H9v2H7V8H5v12h14V8h-2v2h-2V8Z"/>
                </svg>              
            </a>
        </nav> -->

        <div class="flex items-center gap-2 sm:gap-3">
            <!-- Mobile Menu Button -->
            <div x-data="{ 
                open: false, 
                currentPath: '',
                init() {
                    this.currentPath = window.location.pathname;
                },
                isActive(path) {
                    const normalizedPath = this.currentPath.replace(/\/$/, '').replace(/\.html$/, '');
                    const normalizedTarget = path.replace(/\/$/, '').replace(/\.html$/, '');
                    if (normalizedTarget === '') {
                        return normalizedPath === '' || normalizedPath === '/';
                    }
                    return normalizedPath === normalizedTarget || normalizedPath.startsWith(normalizedTarget + '/');
                }
            }" class="sm:hidden relative">
                <button @click="open = !open" class="btn !px-2">
                    <svg class="size-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M3 6h18v2H3V6Zm0 5h18v2H3v-2Zm0 5h18v2H3v-2Z"/></svg>
                </button>
                <div 
                    x-show="open"
                    @click.away="open = false"
                    x-transition
                    class="absolute right-0 mt-2 w-48 bg-white dark:bg-black border border-gray-300 dark:border-gray-700 rounded shadow-lg z-50"
                >
                    <a 
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                        :class="isActive('/') ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        href="/"
                    >
                        Icons
                    </a>
                    <a 
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                        :class="isActive('/about') ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        href="/about"
                    >
                        About
                    </a>
                    <a 
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                        :class="isActive('/legacy') ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        href="/legacy"
                    >
                        Legacy
                    </a>
                </div>
            </div>
            <!-- Theme Toggle -->
            <div x-data="{ 
                theme: 'system',
                open: false,
                get currentTheme() {
                    if (this.theme === 'system') {
                        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                    }
                    return this.theme;
                },
                init() {
                    // Load theme from localStorage
                    const stored = localStorage.getItem('theme');
                    if (stored && ['light', 'dark', 'system'].includes(stored)) {
                        this.theme = stored;
                    } else {
                        this.theme = 'system';
                    }
                    this.applyTheme();
                    
                    // Watch for system theme changes
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                        if (this.theme === 'system') {
                            this.applyTheme();
                        }
                    });
                },
                setTheme(newTheme) {
                    this.theme = newTheme;
                    localStorage.setItem('theme', newTheme);
                    this.applyTheme();
                    this.open = false;
                },
                applyTheme() {
                    const effectiveTheme = this.currentTheme;
                    if (effectiveTheme === 'dark') {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                }
            }" class="relative">
                <button 
                    @click="open = !open"
                    class="btn !px-2"
                    :title="'Current theme: ' + theme"
                >
                <svg x-show="currentTheme === 'light'" class="size-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 22H8V20H18V22ZM8 20H6V18H8V20ZM20 20H18V18H20V20ZM6 18H4V16H6V18ZM22 18H20V14H18V12H20V10H22V18ZM4 16H2V6H4V16ZM18 16H12V14H18V16ZM12 14H10V12H12V14ZM10 12H8V6H10V12ZM6 6H4V4H6V6ZM14 4H12V6H10V4H6V2H14V4Z" fill="currentColor"/>
                    </svg>
                    <svg x-show="currentTheme === 'dark'" class="size-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13 22H11V19H13V22ZM7 19H5V17H7V19ZM19 19H17V17H19V19ZM15 17H9V15H15V17ZM9 15H7V9H9V15ZM17 15H15V9H17V15ZM5 13H2V11H5V13ZM22 13H19V11H22V13ZM15 9H9V7H15V9ZM7 7H5V5H7V7ZM19 7H17V5H19V7ZM13 5H11V2H13V5Z" fill="currentColor"/>
                        </svg>
                            
                            
                </button>
                <div 
                    x-show="open"
                    @click.away="open = false"
                    x-transition
                    class="absolute right-0 mt-2 w-40 bg-white dark:bg-black border border-gray-300 dark:border-gray-700 rounded shadow-lg z-50"
                >
                    <button 
                        @click="setTheme('light')"
                        :class="theme === 'light' ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    >
                        Light
                    </button>
                    <button 
                        @click="setTheme('dark')"
                        :class="theme === 'dark' ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    >
                        Dark
                    </button>
                    <button 
                        @click="setTheme('system')"
                        :class="theme === 'system' ? 'bg-gray-100 dark:bg-gray-800' : ''"
                        class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    >
                        System
                    </button>
                </div>
            </div>
            
            <a class="btn btn-primary text-xs sm:text-base" href="https://halfmage.gumroad.com/l/pixelarticons">
                <svg class="size-6" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 22H5V20H19V22ZM9 6H15V4H17V6H21V20H19V8H17V10H15V8H9V10H7V8H5V20H3V6H7V4H9V6ZM15 4H9V2H15V4Z" fill="currentColor"/>
                </svg>
                <span class="hidden sm:inline">Buy now</span>
            </a>
        </div>
    </div>
</header>